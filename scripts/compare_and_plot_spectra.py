#Plot the spectra from their rat-pac files and from the original data files to check the rat-pac files are correctly produced

import numpy as np
import matplotlib.pyplot as plt
import pdb
import os
from scipy import integrate

dirname = os.path.dirname(os.path.realpath(__file__))

#Data taken from .ratdb files for each component

Ebrat=[0,0.02,0.04,0.06,0.08,0.1,0.12,0.14,0.16,0.18,0.2,0.22,0.24,0.26,0.28,0.3,0.32,0.34,0.36,0.38,0.4,0.42,0.44,0.46,0.48,0.5,0.52,0.54,0.56,0.58,0.6,0.62,0.64,0.66,0.68,0.7,0.72,0.74,0.76,0.78,0.8,0.82,0.84,0.86,0.88,0.9,0.92,0.94,0.96,0.98,1,1.02,1.04,1.06,1.08,1.1,1.12,1.14,1.16,1.18,1.2,1.22,1.24,1.26,1.28,1.3,1.32,1.34,1.36,1.38,1.4,1.42,1.44,1.46,1.48,1.5,1.52,1.54,1.56,1.58,1.6,1.62,1.64,1.66,1.68,1.7,1.72,1.74,1.76,1.78,1.8,1.82,1.84,1.86,1.88,1.9,1.92,1.94,1.96,1.98,2,2.02,2.04,2.06,2.08,2.1,2.12,2.14,2.16,2.18,2.2,2.22,2.24,2.26,2.28,2.3,2.32,2.34,2.36,2.38,2.4,2.42,2.44,2.46,2.48,2.5,2.52,2.54,2.56,2.58,2.6,2.62,2.64,2.66,2.68,2.7,2.72,2.74,2.76,2.78,2.8,2.82,2.84,2.86,2.88,2.9,2.92,2.94,2.96,2.98,3,3.02,3.04,3.06,3.08,3.1,3.12,3.14,3.16,3.18,3.2,3.22,3.24,3.26,3.28,3.3,3.32,3.34,3.36,3.38,3.4,3.42,3.44,3.46,3.48,3.5,3.52,3.54,3.56,3.58,3.6,3.62,3.64,3.66,3.68,3.7,3.72,3.74,3.76,3.78,3.8,3.82,3.84,3.86,3.88,3.9,3.92,3.94,3.96,3.98,4,4.02,4.04,4.06,4.08,4.1,4.12,4.14,4.16,4.18,4.2,4.22,4.24,4.26,4.28,4.3,4.32,4.34,4.36,4.38,4.4,4.42,4.44,4.46,4.48,4.5,4.52,4.54,4.56,4.58,4.6,4.62,4.64,4.66,4.68,4.7,4.72,4.74,4.76,4.78,4.8,4.82,4.84,4.86,4.88,4.9,4.92,4.94,4.96,4.98,5,5.02,5.04,5.06,5.08,5.1,5.12,5.14,5.16,5.18,5.2,5.22,5.24,5.26,5.28,5.3,5.32,5.34,5.36,5.38,5.4,5.42,5.44,5.46,5.48,5.5,5.52,5.54,5.56,5.58,5.6,5.62,5.64,5.66,5.68,5.7,5.72,5.74,5.76,5.78,5.8,5.82,5.84,5.86,5.88,5.9,5.92,5.94,5.96,5.98,6,6.02,6.04,6.06,6.08,6.1,6.12,6.14,6.16,6.18,6.2,6.22,6.24,6.26,6.28,6.3,6.32,6.34,6.36,6.38,6.4,6.42,6.44,6.46,6.48,6.5,6.52,6.54,6.56,6.58,6.6,6.62,6.64,6.66,6.68,6.7,6.72,6.74,6.76,6.78,6.8,6.82,6.84,6.86,6.88,6.9,6.92,6.94,6.96,6.98,7,7.02,7.04,7.06,7.08,7.1,7.12,7.14,7.16,7.18,7.2,7.22,7.24,7.26,7.28,7.3,7.32,7.34,7.36,7.38,7.4,7.42,7.44,7.46,7.48,7.5,7.52,7.54,7.56,7.58,7.6,7.62,7.64,7.66,7.68,7.7,7.72,7.74,7.76,7.78,7.8,7.82,7.84,7.86,7.88,7.9,7.92,7.94,7.96,7.98,8,8.02,8.04,8.06,8.08,8.1,8.12,8.14,8.16,8.18,8.2,8.22,8.24,8.26,8.28,8.3,8.32,8.34,8.36,8.38,8.4,8.42,8.44,8.46,8.48,8.5,8.52,8.54,8.56,8.58,8.6,8.62,8.64,8.66,8.68,8.7,8.72,8.74,8.76,8.78,8.8,8.82,8.84,8.86,8.88,8.9,8.92,8.94,8.96,8.98,9,9.02,9.04,9.06,9.08,9.1,9.12,9.14,9.16,9.18,9.2,9.22,9.24,9.26,9.28,9.3,9.32,9.34,9.36,9.38,9.4,9.42,9.44,9.46,9.48,9.5,9.52,9.54,9.56,9.58,9.6,9.62,9.64,9.66,9.68,9.7,9.72,9.74,9.76,9.78,9.8,9.82,9.84,9.86,9.88,9.9,9.92,9.94,9.96,9.98,10,10.02,10.04,10.06,10.08,10.1,10.12,10.14,10.16,10.18,10.2,10.22,10.24,10.26,10.28,10.3,10.32,10.34,10.36,10.38,10.4,10.42,10.44,10.46,10.48,10.5,10.52,10.54,10.56,10.58,10.6,10.62,10.64,10.66,10.68,10.7,10.72,10.74,10.76,10.78,10.8,10.82,10.84,10.86,10.88,10.9,10.92,10.94,10.96,10.98,11,11.02,11.04,11.06,11.08,11.1,11.12,11.14,11.16,11.18,11.2,11.22,11.24,11.26,11.28,11.3,11.32,11.34,11.36,11.38,11.4,11.42,11.44,11.46,11.48,11.5,11.52,11.54,11.56,11.58,11.6,11.62,11.64,11.66,11.68,11.7,11.72,11.74,11.76,11.78,11.8,11.82,11.84,11.86,11.88,11.9,11.92,11.94,11.96,11.98,12,12.02,12.04,12.06,12.08,12.1,12.12,12.14,12.16,12.18,12.2,12.22,12.24,12.26,12.28,12.3,12.32,12.34,12.36,12.38,12.4,12.42,12.44,12.46,12.48,12.5,12.52,12.54,12.56,12.58,12.6,12.62,12.64,12.66,12.68,12.7,12.72,12.74,12.76,12.78,12.8,12.82,12.84,12.86,12.88,12.9,12.92,12.94,12.96,12.98,13,13.02,13.04,13.06,13.08,13.1,13.12,13.14,13.16,13.18,13.2,13.22,13.24,13.26,13.28,13.3,13.32,13.34,13.36,13.38,13.4,13.42,13.44,13.46,13.48,13.5,13.52,13.54,13.56,13.58,13.6,13.62,13.64,13.66,13.68,13.7,13.72,13.74,13.76,13.78,13.8,13.82,13.84,13.86,13.88,13.9,13.92,13.94,13.96,13.98,14,14.02,14.04,14.06,14.08,14.1,14.12,14.14,14.16,14.18,14.2,14.22,14.24,14.26,14.28,14.3,14.32,14.34,14.36,14.38,14.4,14.42,14.44,14.46,14.48,14.5,14.52,14.54,14.56,14.58,14.6,14.62,14.64,14.66,14.68,14.7,14.72,14.74,14.76,14.78,14.8,14.82,14.84,14.86,14.88,14.9,14.92,14.94,14.96,14.98,15,15.02,15.04,15.06,15.08,15.1,15.12,15.14,15.16,15.18,15.2,15.22,15.24,15.26,15.28,15.3,15.32,15.34,15.36,15.38,15.4,15.42,15.44,15.46,15.48,15.5,15.52,15.54,15.56,15.58,15.6,15.62,15.64,15.66,15.68,15.7,15.72,15.74,15.76,15.78,15.8,15.82,15.84,15.86,15.88,15.9,15.92,15.94,15.96,15.98,16,16.02,16.04,16.06,16.08,16.1,16.12,16.14,16.16,16.18,16.2,16.22,16.24,16.26,16.28,16.3,16.32,16.34,16.36,16.38,16.4,16.42,16.44,16.46,16.48,16.5,16.52,16.54]
fbrat=[0,23.908,94.52,209.06,365.29,561.28,794.8,1063.3,1365.5,1699.1,2061.9,2451.7,2866.7,3304,3760.8,4231.2,4703.5,5184.1,5762.9,6366.5,6993.4,7640.3,8311.4,9017.5,9746.1,10496,11262,12055,12883,13734,14605,15495,16409,17349,18309,19288,20285,21304,22344,23401,24476,25565,26679,27810,28958,30121,31294,32496,33714,34948,36194,37451,38735,40033,41345,42669,44003,45361,46731,48114,49508,50913,52337,53772,55218,56674,58141,59622,61114,62615,64124,65644,67178,68722,70275,71834,73403,74985,76575,78172,79776,81388,83011,84640,86275,87916,89564,91221,92883,94549,96218,97898,99585,1.0128e+05,1.0297e+05,1.0467e+05,1.0638e+05,1.0809e+05,1.098e+05,1.1152e+05,1.1324e+05,1.1497e+05,1.167e+05,1.1843e+05,1.2017e+05,1.2191e+05,1.2365e+05,1.254e+05,1.2715e+05,1.289e+05,1.3065e+05,1.3241e+05,1.3416e+05,1.3592e+05,1.3768e+05,1.3944e+05,1.4121e+05,1.4297e+05,1.4474e+05,1.465e+05,1.4826e+05,1.5003e+05,1.518e+05,1.5356e+05,1.5533e+05,1.5709e+05,1.5886e+05,1.6063e+05,1.6239e+05,1.6415e+05,1.6591e+05,1.6768e+05,1.6944e+05,1.712e+05,1.7295e+05,1.7471e+05,1.7646e+05,1.7821e+05,1.7996e+05,1.817e+05,1.8345e+05,1.8519e+05,1.8693e+05,1.8867e+05,1.904e+05,1.9213e+05,1.9386e+05,1.9558e+05,1.973e+05,1.9902e+05,2.0073e+05,2.0244e+05,2.0415e+05,2.0585e+05,2.0754e+05,2.0924e+05,2.1092e+05,2.1261e+05,2.1428e+05,2.1595e+05,2.1762e+05,2.1929e+05,2.2095e+05,2.226e+05,2.2424e+05,2.2588e+05,2.2752e+05,2.2915e+05,2.3077e+05,2.3239e+05,2.34e+05,2.3561e+05,2.3721e+05,2.388e+05,2.4038e+05,2.4196e+05,2.4354e+05,2.451e+05,2.4666e+05,2.4821e+05,2.4976e+05,2.513e+05,2.5283e+05,2.5435e+05,2.5586e+05,2.5737e+05,2.5887e+05,2.6037e+05,2.6185e+05,2.6333e+05,2.648e+05,2.6626e+05,2.6771e+05,2.6915e+05,2.7059e+05,2.7202e+05,2.7345e+05,2.7486e+05,2.7625e+05,2.7765e+05,2.7904e+05,2.8042e+05,2.8178e+05,2.8314e+05,2.8449e+05,2.8583e+05,2.8717e+05,2.8849e+05,2.898e+05,2.911e+05,2.924e+05,2.9368e+05,2.9496e+05,2.9622e+05,2.9748e+05,2.9873e+05,2.9997e+05,3.0119e+05,3.0241e+05,3.0362e+05,3.0481e+05,3.06e+05,3.0717e+05,3.0834e+05,3.095e+05,3.1064e+05,3.1178e+05,3.129e+05,3.1402e+05,3.1512e+05,3.1622e+05,3.173e+05,3.1837e+05,3.1943e+05,3.2048e+05,3.2153e+05,3.2255e+05,3.2357e+05,3.2458e+05,3.2558e+05,3.2656e+05,3.2754e+05,3.285e+05,3.2945e+05,3.3039e+05,3.3132e+05,3.3224e+05,3.3314e+05,3.3404e+05,3.3493e+05,3.358e+05,3.3666e+05,3.3751e+05,3.3835e+05,3.3918e+05,3.4e+05,3.408e+05,3.4159e+05,3.4238e+05,3.4315e+05,3.4391e+05,3.4465e+05,3.4538e+05,3.4611e+05,3.4682e+05,3.4752e+05,3.482e+05,3.4888e+05,3.4955e+05,3.502e+05,3.5084e+05,3.5146e+05,3.5208e+05,3.5269e+05,3.5328e+05,3.5386e+05,3.5442e+05,3.5498e+05,3.5553e+05,3.5606e+05,3.5658e+05,3.5708e+05,3.5758e+05,3.5806e+05,3.5853e+05,3.5899e+05,3.5944e+05,3.5987e+05,3.603e+05,3.6071e+05,3.611e+05,3.6149e+05,3.6186e+05,3.6223e+05,3.6258e+05,3.6291e+05,3.6324e+05,3.6355e+05,3.6385e+05,3.6414e+05,3.6441e+05,3.6468e+05,3.6493e+05,3.6518e+05,3.654e+05,3.6562e+05,3.6582e+05,3.6601e+05,3.662e+05,3.6636e+05,3.6651e+05,3.6666e+05,3.6679e+05,3.6691e+05,3.6702e+05,3.6711e+05,3.6719e+05,3.6726e+05,3.6732e+05,3.6737e+05,3.674e+05,3.6742e+05,3.6744e+05,3.6744e+05,3.6742e+05,3.6739e+05,3.6736e+05,3.6731e+05,3.6725e+05,3.6717e+05,3.6709e+05,3.6699e+05,3.6689e+05,3.6677e+05,3.6663e+05,3.6649e+05,3.6633e+05,3.6617e+05,3.6599e+05,3.658e+05,3.6559e+05,3.6538e+05,3.6516e+05,3.6492e+05,3.6467e+05,3.6441e+05,3.6414e+05,3.6386e+05,3.6357e+05,3.6326e+05,3.6294e+05,3.6262e+05,3.6228e+05,3.6193e+05,3.6156e+05,3.6119e+05,3.6081e+05,3.6042e+05,3.6001e+05,3.5959e+05,3.5916e+05,3.5873e+05,3.5828e+05,3.5782e+05,3.5734e+05,3.5686e+05,3.5637e+05,3.5587e+05,3.5535e+05,3.5483e+05,3.5429e+05,3.5375e+05,3.5319e+05,3.5262e+05,3.5204e+05,3.5146e+05,3.5086e+05,3.5025e+05,3.4963e+05,3.49e+05,3.4836e+05,3.4771e+05,3.4705e+05,3.4638e+05,3.457e+05,3.4501e+05,3.4432e+05,3.4361e+05,3.4288e+05,3.4215e+05,3.4142e+05,3.4067e+05,3.3991e+05,3.3914e+05,3.3837e+05,3.3758e+05,3.3679e+05,3.3598e+05,3.3516e+05,3.3434e+05,3.3351e+05,3.3267e+05,3.3182e+05,3.3095e+05,3.3009e+05,3.2921e+05,3.2833e+05,3.2743e+05,3.2652e+05,3.2561e+05,3.2469e+05,3.2376e+05,3.2282e+05,3.2187e+05,3.2092e+05,3.1996e+05,3.1899e+05,3.18e+05,3.1702e+05,3.1602e+05,3.1502e+05,3.1401e+05,3.1298e+05,3.1196e+05,3.1092e+05,3.0988e+05,3.0883e+05,3.0777e+05,3.067e+05,3.0563e+05,3.0455e+05,3.0346e+05,3.0236e+05,3.0127e+05,3.0016e+05,2.9904e+05,2.9792e+05,2.9678e+05,2.9565e+05,2.9451e+05,2.9336e+05,2.922e+05,2.9103e+05,2.8987e+05,2.8869e+05,2.8751e+05,2.8632e+05,2.8512e+05,2.8392e+05,2.8272e+05,2.815e+05,2.8028e+05,2.7906e+05,2.7783e+05,2.7659e+05,2.7535e+05,2.741e+05,2.7285e+05,2.7159e+05,2.7033e+05,2.6906e+05,2.6778e+05,2.665e+05,2.6522e+05,2.6394e+05,2.6264e+05,2.6134e+05,2.6004e+05,2.5873e+05,2.5742e+05,2.561e+05,2.5477e+05,2.5345e+05,2.5213e+05,2.5079e+05,2.4945e+05,2.4811e+05,2.4676e+05,2.4542e+05,2.4406e+05,2.427e+05,2.4134e+05,2.3998e+05,2.3862e+05,2.3724e+05,2.3587e+05,2.3449e+05,2.3311e+05,2.3173e+05,2.3034e+05,2.2895e+05,2.2756e+05,2.2617e+05,2.2477e+05,2.2337e+05,2.2196e+05,2.2056e+05,2.1916e+05,2.1775e+05,2.1634e+05,2.1492e+05,2.1351e+05,2.1209e+05,2.1068e+05,2.0925e+05,2.0783e+05,2.0641e+05,2.0499e+05,2.0356e+05,2.0213e+05,2.007e+05,1.9927e+05,1.9785e+05,1.9642e+05,1.9498e+05,1.9354e+05,1.9212e+05,1.9068e+05,1.8925e+05,1.8781e+05,1.8637e+05,1.8494e+05,1.8351e+05,1.8207e+05,1.8063e+05,1.792e+05,1.7777e+05,1.7634e+05,1.749e+05,1.7346e+05,1.7203e+05,1.706e+05,1.6917e+05,1.6774e+05,1.663e+05,1.6488e+05,1.6346e+05,1.6203e+05,1.606e+05,1.5917e+05,1.5776e+05,1.5634e+05,1.5492e+05,1.535e+05,1.5208e+05,1.5067e+05,1.4927e+05,1.4786e+05,1.4644e+05,1.4504e+05,1.4364e+05,1.4224e+05,1.4085e+05,1.3944e+05,1.3806e+05,1.3667e+05,1.3529e+05,1.339e+05,1.3251e+05,1.3114e+05,1.2977e+05,1.2841e+05,1.2704e+05,1.2566e+05,1.2431e+05,1.2296e+05,1.2161e+05,1.2026e+05,1.1891e+05,1.1757e+05,1.1624e+05,1.1491e+05,1.1358e+05,1.1225e+05,1.1094e+05,1.0963e+05,1.0832e+05,1.0701e+05,1.0571e+05,1.0442e+05,1.0313e+05,1.0185e+05,1.0056e+05,99283,98020,96759,95500,94236,92994,91758,90525,89293,88057,86847,85642,84438,83236,82032,80854,79680,78508,77337,76169,75024,73883,72745,71607,70477,69367,68262,67159,66055,64965,63893,62825,61759,60691,59644,58611,57581,56554,55521,54521,53528,52539,51552,50561,49605,48655,47708,46762,45817,44905,43998,43095,42191,41295,40428,39566,38707,37847,37001,36181,35365,34552,33734,32942,32169,31401,30634,29859,29124,28400,27680,26960,26230,25552,24877,24206,23535,22859,22232,21608,20986,20362,19743,19166,18593,18022,17445,16884,16359,15837,15315,14784,14283,13810,13340,12868,12380,11943,11522,11102,10679,10236,9863.2,9492.6,9122.3,8747.5,8361.4,8038.6,7717.3,7395.4,7066.5,6737.9,6462.7,6188.3,5912.5,5627.3,5354.8,5124.4,4893.9,4660.9,4416.3,4198.1,4008.2,3817.8,3624.6,3415.5,3248.4,3094.4,2939.9,2781.7,2605.4,2482.5,2359.7,2236.2,2108.6,1972.1,1875.9,1779.5,1682.2,1580.7,1478.1,1403.6,1328.8,1252.9,1172.6,1097.5,1040.6,983.01,924.63,861.52,808.15,764.78,721.13,676.37,626.33,589.64,556.83,523.75,489.56,450.36,425.9,401.43,376.69,350.84,322.76,304.69,286.34,267.71,248.25,228.52,214.89,201.55,187.65,172.92,159.57,149.56,139.56,129.55,118.43,109.25,102.3,95.076,87.57,79.23,73.392,68.388,63.384,58.102,51.986,48.372,45.036,41.422,37.53,33.638,31.136,28.634,26.41,23.63,21.128,19.46,17.792,16.124,14.456,12.788,11.676,10.564,9.452,8.34,7.506,6.672,6.116,5.282,4.448,4.17,3.614,3.336,2.78,2.502,2.224,1.946,1.668,1.39,1.112,1.112,0.834,0.834,0.556,0.556,0.556,0.278,0.278,0.278,0.278,0.278,0.278,0,0,0,0,0,0,0,0,0,0]

Ebe1rat=[0.38263,0.38273,0.38283,0.38293,0.38303,0.38313,0.38323,0.38333,0.38343,0.38353,0.38363,0.38373,0.38383,0.38393,0.38403,0.38413,0.38423,0.38433,0.38443,0.38453,0.38463,0.38473,0.38483,0.38493,0.38503,0.38513,0.38523,0.38533,0.38543,0.38553,0.38563,0.38573,0.38583,0.38593,0.38603,0.38613,0.38623,0.38633,0.38643,0.38653,0.38663,0.38673,0.38683,0.38693,0.38703,0.38713,0.38723,0.38733,0.38743,0.38753,0.38763,0.38773,0.38783,0.38793,0.38803,0.38813,0.38823,0.38833,0.38843,0.38853,0.38863,0.38873,0.38883,0.38893,0.38903,0.38913,0.38923,0.38933,0.38943,0.38953,0.38963,0.38973,0.38983,0.38993,0.39003,0.39013,0.39023,0.39033,0.39043,0.39053,0.39063,0.39073,0.39083,0.39093,0.39103,0.39113,0.39123,0.39133,0.39143,0.39153,0.39163]
fbe1rat=[0,0,5000,20000,60000,1.6e+05,4.1e+05,9.85e+05,2.21e+06,4.64e+06,9.125e+06,1.6795e+07,2.8935e+07,4.669e+07,7.0575e+07,1.0007e+08,1.3333e+08,1.6724e+08,1.9814e+08,2.2258e+08,2.3831e+08,2.4466e+08,2.4258e+08,2.3404e+08,2.2142e+08,2.0688e+08,1.9195e+08,1.776e+08,1.6423e+08,1.5198e+08,1.4076e+08,1.3048e+08,1.2102e+08,1.1228e+08,1.0419e+08,9.6695e+07,8.973e+07,8.3275e+07,7.7275e+07,7.171e+07,6.654e+07,6.1735e+07,5.7275e+07,5.3135e+07,4.929e+07,4.5725e+07,4.241e+07,3.9335e+07,3.6475e+07,3.3825e+07,3.137e+07,2.9085e+07,2.697e+07,2.5005e+07,2.318e+07,2.149e+07,1.992e+07,1.8465e+07,1.7115e+07,1.5865e+07,1.4705e+07,1.363e+07,1.263e+07,1.1705e+07,1.0845e+07,1.005e+07,9.315e+06,8.63e+06,8e+06,7.41e+06,6.865e+06,6.36e+06,5.895e+06,5.46e+06,5.06e+06,4.685e+06,4.34e+06,4.025e+06,3.725e+06,3.45e+06,3.2e+06,2.96e+06,2.745e+06,2.54e+06,2.355e+06,2.18e+06,2.02e+06,1.87e+06,1.735e+06,1.605e+06,1.485e+06]

Ebe2rat=[0.86049,0.86059,0.86069,0.86079,0.86089,0.86099,0.86109,0.86119,0.86129,0.86139,0.86149,0.86159,0.86169,0.86179,0.86189,0.86199,0.86209,0.86219,0.86229,0.86239,0.86249,0.86259,0.86269,0.86279,0.86289,0.86299,0.86309,0.86319,0.86329,0.86339,0.86349,0.86359,0.86369,0.86379,0.86389,0.86399,0.86409,0.86419,0.86429,0.86439,0.86449,0.86459,0.86469,0.86479,0.86489,0.86499,0.86509,0.86519,0.86529,0.86539,0.86549,0.86559,0.86569,0.86579,0.86589,0.86599,0.86609,0.86619,0.86629,0.86639,0.86649,0.86659,0.86669,0.86679,0.86689,0.86699,0.86709,0.86719,0.86729,0.86739,0.86749,0.86759,0.86769,0.86779,0.86789,0.86799,0.86809,0.86819,0.86829,0.86839,0.86849,0.86859]
fbe2rat=[0,0,28800,3.168e+05,2.6928e+06,1.6589e+07,7.2936e+07,2.2831e+08,5.1036e+08,8.268e+08,1.0057e+09,9.8541e+08,8.6433e+08,7.5063e+08,6.727e+08,6.1691e+08,5.705e+08,5.2877e+08,4.9046e+08,4.5508e+08,4.2235e+08,3.9203e+08,3.639e+08,3.3782e+08,3.136e+08,2.9111e+08,2.7022e+08,2.5082e+08,2.3279e+08,2.1606e+08,2.0051e+08,1.8606e+08,1.7264e+08,1.6019e+08,1.4861e+08,1.3787e+08,1.2789e+08,1.1863e+08,1.1003e+08,1.0205e+08,9.4651e+07,8.7768e+07,8.1389e+07,7.547e+07,6.997e+07,6.4872e+07,6.0149e+07,5.5757e+07,5.1696e+07,4.7923e+07,4.4424e+07,4.117e+07,3.816e+07,3.5381e+07,3.2789e+07,3.0384e+07,2.8166e+07,2.6093e+07,2.4178e+07,2.2406e+07,2.0765e+07,1.9238e+07,1.7827e+07,1.6517e+07,1.5307e+07,1.4184e+07,1.3147e+07,1.2182e+07,1.1275e+07,1.0454e+07,9.6912e+06,8.9712e+06,8.3088e+06,7.704e+06,7.128e+06,6.6096e+06,6.12e+06,5.6736e+06,5.256e+06,4.8672e+06,4.5072e+06,4.176e+06]

ECNOrat=[0.0036394,0.02118,0.038721,0.056262,0.073802,0.091343,0.10888,0.12642,0.14397,0.16151,0.17905,0.19659,0.21413,0.23167,0.24921,0.26675,0.28429,0.30183,0.31937,0.33691,0.35445,0.372,0.38954,0.40708,0.42462,0.44216,0.4597,0.47724,0.49478,0.51232,0.52986,0.5474,0.56494,0.58248,0.60003,0.61757,0.63511,0.65265,0.67019,0.68773,0.70527,0.72281,0.74035,0.75789,0.77543,0.79297,0.81051,0.82806,0.8456,0.86314,0.88068,0.89822,0.91576,0.9333,0.95084,0.96838,0.98592,1.0035,1.021,1.0385,1.0561,1.0736,1.0912,1.1087,1.1262,1.1438,1.1613,1.1789,1.1964,1.214,1.2315,1.249,1.2666,1.2841,1.3017,1.3192,1.3367,1.3543,1.3718,1.3894,1.4069,1.4244,1.442,1.4595,1.4771,1.4946,1.5121,1.5297,1.5472,1.5648,1.5823,1.5998,1.6174,1.6349,1.6525,1.67,1.6876,1.7051,1.7226,1.7226]
fCNOrat=[4.1836e+08,2.0874e+09,5.0399e+09,9.1949e+09,1.4473e+10,2.0797e+10,2.8091e+10,2.8612e+10,4.3491e+10,5.3123e+10,6.3451e+10,7.4408e+10,8.5929e+10,9.7946e+10,1.104e+11,1.3453e+11,1.3754e+11,1.5096e+11,1.6457e+11,1.7831e+11,1.9214e+11,1.6714e+11,2.1744e+11,2.3125e+11,2.4505e+11,2.5852e+11,2.7188e+11,2.85e+11,2.9783e+11,3.1034e+11,3.2249e+11,3.6654e+11,3.4683e+11,3.5766e+11,3.0436e+11,3.7659e+11,3.8597e+11,3.9477e+11,4.0295e+11,4.105e+11,4.1739e+11,4.236e+11,4.291e+11,4.3389e+11,4.3793e+11,4.4122e+11,4.4372e+11,4.9432e+11,3.8076e+11,4.4833e+11,4.4755e+11,4.4609e+11,4.4378e+11,4.406e+11,4.3653e+11,4.3155e+11,4.2565e+11,4.188e+11,4.1096e+11,4.021e+11,3.9216e+11,3.4393e+11,4.2542e+11,3.5896e+11,3.4373e+11,3.2631e+11,3.0562e+11,2.7848e+11,2.5404e+11,2.5109e+11,2.4782e+11,2.4425e+11,2.4036e+11,2.3616e+11,2.3182e+11,2.2682e+11,2.217e+11,2.1627e+11,2.5178e+11,2.0328e+11,1.9689e+11,1.902e+11,1.8321e+11,1.7593e+11,1.6834e+11,1.6045e+11,1.5224e+11,1.4371e+11,1.3484e+11,1.2561e+11,1.1599e+11,1.0594e+11,9.5377e+10,8.4212e+10,8.5163e+10,5.6537e+10,4.1539e+10,2.3255e+10,2.6915e+09,0]

Eheprat=[0.018784,0.037567,0.056351,0.075135,0.093919,0.1127,0.13149,0.15027,0.16905,0.18784,0.20662,0.2254,0.24419,0.26297,0.28176,0.30054,0.31932,0.33811,0.35689,0.37567,0.39446,0.41324,0.43203,0.45081,0.46959,0.48838,0.50716,0.52594,0.54473,0.56351,0.5823,0.60108,0.61986,0.63865,0.65743,0.67621,0.695,0.71378,0.73257,0.75135,0.77013,0.78892,0.8077,0.82648,0.84527,0.86405,0.88284,0.90162,0.9204,0.93919,0.95797,0.97675,0.99554,1.0143,1.0331,1.0519,1.0707,1.0895,1.1082,1.127,1.1458,1.1646,1.1834,1.2022,1.2209,1.2397,1.2585,1.2773,1.2961,1.3149,1.3336,1.3524,1.3712,1.39,1.4088,1.4276,1.4463,1.4651,1.4839,1.5027,1.5215,1.5403,1.559,1.5778,1.5966,1.6154,1.6342,1.653,1.6718,1.6905,1.7093,1.7281,1.7469,1.7657,1.7845,1.8032,1.822,1.8408,1.8596,1.8784,1.8972,1.9159,1.9347,1.9535,1.9723,1.9911,2.0099,2.0286,2.0474,2.0662,2.085,2.1038,2.1226,2.1413,2.1601,2.1789,2.1977,2.2165,2.2353,2.254,2.2728,2.2916,2.3104,2.3292,2.348,2.3668,2.3855,2.4043,2.4231,2.4419,2.4607,2.4795,2.4982,2.517,2.5358,2.5546,2.5734,2.5922,2.6109,2.6297,2.6485,2.6673,2.6861,2.7049,2.7236,2.7424,2.7612,2.78,2.7988,2.8176,2.8363,2.8551,2.8739,2.8927,2.9115,2.9303,2.949,2.9678,2.9866,3.0054,3.0242,3.043,3.0617,3.0805,3.0993,3.1181,3.1369,3.1557,3.1745,3.1932,3.212,3.2308,3.2496,3.2684,3.2872,3.3059,3.3247,3.3435,3.3623,3.3811,3.3999,3.4186,3.4374,3.4562,3.475,3.4938,3.5126,3.5313,3.5501,3.5689,3.5877,3.6065,3.6253,3.644,3.6628,3.6816,3.7004,3.7192,3.738,3.7567,3.7755,3.7943,3.8131,3.8319,3.8507,3.8694,3.8882,3.907,3.9258,3.9446,3.9634,3.9822,4.0009,4.0197,4.0385,4.0573,4.0761,4.0949,4.1136,4.1324,4.1512,4.17,4.1888,4.2076,4.2263,4.2451,4.2639,4.2827,4.3015,4.3203,4.339,4.3578,4.3766,4.3954,4.4142,4.433,4.4517,4.4705,4.4893,4.5081,4.5269,4.5457,4.5644,4.5832,4.602,4.6208,4.6396,4.6584,4.6771,4.6959,4.7147,4.7335,4.7523,4.7711,4.7899,4.8086,4.8274,4.8462,4.865,4.8838,4.9026,4.9213,4.9401,4.9589,4.9777,4.9965,5.0153,5.034,5.0528,5.0716,5.0904,5.1092,5.128,5.1467,5.1655,5.1843,5.2031,5.2219,5.2407,5.2594,5.2782,5.297,5.3158,5.3346,5.3534,5.3721,5.3909,5.4097,5.4285,5.4473,5.4661,5.4848,5.5036,5.5224,5.5412,5.56,5.5788,5.5976,5.6163,5.6351,5.6539,5.6727,5.6915,5.7103,5.729,5.7478,5.7666,5.7854,5.8042,5.823,5.8417,5.8605,5.8793,5.8981,5.9169,5.9357,5.9544,5.9732,5.992,6.0108,6.0296,6.0484,6.0671,6.0859,6.1047,6.1235,6.1423,6.1611,6.1798,6.1986,6.2174,6.2362,6.255,6.2738,6.2926,6.3113,6.3301,6.3489,6.3677,6.3865,6.4053,6.424,6.4428,6.4616,6.4804,6.4992,6.518,6.5367,6.5555,6.5743,6.5931,6.6119,6.6307,6.6494,6.6682,6.687,6.7058,6.7246,6.7434,6.7621,6.7809,6.7997,6.8185,6.8373,6.8561,6.8748,6.8936,6.9124,6.9312,6.95,6.9688,6.9875,7.0063,7.0251,7.0439,7.0627,7.0815,7.1003,7.119,7.1378,7.1566,7.1754,7.1942,7.213,7.2317,7.2505,7.2693,7.2881,7.3069,7.3257,7.3444,7.3632,7.382,7.4008,7.4196,7.4384,7.4571,7.4759,7.4947,7.5135,7.5323,7.5511,7.5698,7.5886,7.6074,7.6262,7.645,7.6638,7.6825,7.7013,7.7201,7.7389,7.7577,7.7765,7.7952,7.814,7.8328,7.8516,7.8704,7.8892,7.908,7.9267,7.9455,7.9643,7.9831,8.0019,8.0207,8.0394,8.0582,8.077,8.0958,8.1146,8.1334,8.1521,8.1709,8.1897,8.2085,8.2273,8.2461,8.2648,8.2836,8.3024,8.3212,8.34,8.3588,8.3775,8.3963,8.4151,8.4339,8.4527,8.4715,8.4902,8.509,8.5278,8.5466,8.5654,8.5842,8.6029,8.6217,8.6405,8.6593,8.6781,8.6969,8.7157,8.7344,8.7532,8.772,8.7908,8.8096,8.8284,8.8471,8.8659,8.8847,8.9035,8.9223,8.9411,8.9598,8.9786,8.9974,9.0162,9.035,9.0538,9.0725,9.0913,9.1101,9.1289,9.1477,9.1665,9.1852,9.204,9.2228,9.2416,9.2604,9.2792,9.2979,9.3167,9.3355,9.3543,9.3731,9.3919,9.4106,9.4294,9.4482,9.467,9.4858,9.5046,9.5234,9.5421,9.5609,9.5797,9.5985,9.6173,9.6361,9.6548,9.6736,9.6924,9.7112,9.73,9.7488,9.7675,9.7863,9.8051,9.8239,9.8427,9.8615,9.8802,9.899,9.9178,9.9366,9.9554,9.9742,9.9929,10.012,10.031,10.049,10.068,10.087,10.106,10.124,10.143,10.162,10.181,10.2,10.218,10.237,10.256,10.275,10.293,10.312,10.331,10.35,10.369,10.387,10.406,10.425,10.444,10.463,10.481,10.5,10.519,10.538,10.556,10.575,10.594,10.613,10.632,10.65,10.669,10.688,10.707,10.726,10.744,10.763,10.782,10.801,10.819,10.838,10.857,10.876,10.895,10.913,10.932,10.951,10.97,10.988,11.007,11.026,11.045,11.064,11.082,11.101,11.12,11.139,11.158,11.176,11.195,11.214,11.233,11.251,11.27,11.289,11.308,11.327,11.345,11.364,11.383,11.402,11.421,11.439,11.458,11.477,11.496,11.514,11.533,11.552,11.571,11.59,11.608,11.627,11.646,11.665,11.683,11.702,11.721,11.74,11.759,11.777,11.796,11.815,11.834,11.853,11.871,11.89,11.909,11.928,11.946,11.965,11.984,12.003,12.022,12.04,12.059,12.078,12.097,12.116,12.134,12.153,12.172,12.191,12.209,12.228,12.247,12.266,12.285,12.303,12.322,12.341,12.36,12.378,12.397,12.416,12.435,12.454,12.472,12.491,12.51,12.529,12.548,12.566,12.585,12.604,12.623,12.641,12.66,12.679,12.698,12.717,12.735,12.754,12.773,12.792,12.811,12.829,12.848,12.867,12.886,12.904,12.923,12.942,12.961,12.98,12.998,13.017,13.036,13.055,13.073,13.092,13.111,13.13,13.149,13.167,13.186,13.205,13.224,13.243,13.261,13.28,13.299,13.318,13.336,13.355,13.374,13.393,13.412,13.43,13.449,13.468,13.487,13.506,13.524,13.543,13.562,13.581,13.599,13.618,13.637,13.656,13.675,13.693,13.712,13.731,13.75,13.768,13.787,13.806,13.825,13.844,13.862,13.881,13.9,13.919,13.938,13.956,13.975,13.994,14.013,14.031,14.05,14.069,14.088,14.107,14.125,14.144,14.163,14.182,14.201,14.219,14.238,14.257,14.276,14.294,14.313,14.332,14.351,14.37,14.388,14.407,14.426,14.445,14.463,14.482,14.501,14.52,14.539,14.557,14.576,14.595,14.614,14.633,14.651,14.67,14.689,14.708,14.726,14.745,14.764,14.783,14.802,14.82,14.839,14.858,14.877,14.895,14.914,14.933,14.952,14.971,14.989,15.008,15.027,15.046,15.065,15.083,15.102,15.121,15.14,15.158,15.177,15.196,15.215,15.234,15.252,15.271,15.29,15.309,15.328,15.346,15.365,15.384,15.403,15.421,15.44,15.459,15.478,15.497,15.515,15.534,15.553,15.572,15.59,15.609,15.628,15.647,15.666,15.684,15.703,15.722,15.741,15.76,15.778,15.797,15.816,15.835,15.853,15.872,15.891,15.91,15.929,15.947,15.966,15.985,16.004,16.023,16.041,16.06,16.079,16.098,16.116,16.135,16.154,16.173,16.192,16.21,16.229,16.248,16.267,16.285,16.304,16.323,16.342,16.361,16.379,16.398,16.417,16.436,16.455,16.473,16.492,16.511,16.53,16.548,16.567,16.586,16.605,16.624,16.642,16.661,16.68,16.699,16.718,16.736,16.755,16.774,16.793,16.811,16.83,16.849,16.868,16.887,16.905,16.924,16.943,16.962,16.98,16.999,17.018,17.037,17.056,17.074,17.093,17.112,17.131,17.15,17.168,17.187,17.206,17.225,17.243,17.262,17.281,17.3,17.319,17.337,17.356,17.375,17.394,17.413,17.431,17.45,17.469,17.488,17.506,17.525,17.544,17.563,17.582,17.6,17.619,17.638,17.657,17.675,17.694,17.713,17.732,17.751,17.769,17.788,17.807,17.826,17.845,17.863,17.882,17.901,17.92,17.938,17.957,17.976,17.995,18.014,18.032,18.051,18.07,18.089,18.108,18.126,18.145,18.164,18.183,18.201,18.22,18.239,18.258,18.277,18.295,18.314,18.333,18.352,18.37,18.389,18.408,18.427,18.446,18.464,18.483,18.502,18.521,18.54,18.558,18.577,18.596,18.615,18.633,18.652,18.671,18.69,18.709,18.727,18.746,18.765]
fheprat=[0.0077896,0.031098,0.069833,0.12391,0.19322,0.2777,0.37723,0.49175,0.62114,0.76534,0.92426,1.0978,1.2858,1.4883,1.7051,1.9362,2.1815,2.4409,2.7142,3.0015,3.3026,3.6174,3.9458,4.2878,4.6433,5.0123,5.3946,5.79,6.1982,6.6201,7.0546,7.5018,7.9617,8.4348,8.92,9.4179,9.9285,10.451,10.987,11.534,12.093,12.665,13.248,13.843,14.45,15.069,15.698,16.341,16.994,17.658,18.334,19.021,19.719,20.428,21.148,21.879,22.621,23.373,24.136,24.909,25.694,26.488,27.293,28.108,28.933,29.768,30.613,31.468,32.333,33.207,34.091,34.985,35.889,36.801,37.723,38.654,39.595,40.545,41.503,42.471,43.448,44.433,45.426,46.429,47.441,48.46,49.488,50.525,51.57,52.623,53.682,54.754,55.831,56.913,58.006,59.11,60.218,61.332,62.457,63.587,64.728,65.873,67.024,68.186,69.353,70.525,71.708,72.896,74.089,75.288,76.497,77.711,78.931,80.161,81.396,82.632,83.878,85.135,86.391,87.659,88.926,90.204,91.487,92.775,94.068,95.367,96.672,97.981,99.296,100.62,101.95,103.28,104.61,105.95,107.3,108.65,110.01,111.37,112.73,114.11,115.48,116.86,118.25,119.63,121.02,122.42,123.82,125.23,126.64,128.05,129.47,130.89,132.32,133.74,135.17,136.61,138.05,139.49,140.94,142.39,143.84,145.3,146.76,148.22,149.69,151.16,152.62,154.1,155.58,157.06,158.54,160.03,161.51,163,164.49,165.99,167.49,168.99,170.49,171.99,173.5,175.01,176.52,178.03,179.54,181.06,182.57,184.09,185.61,187.13,188.66,190.18,191.71,193.24,194.76,196.29,197.83,199.36,200.89,202.42,203.96,205.5,207.03,208.57,210.11,211.65,213.19,214.73,216.27,217.81,219.35,220.89,222.43,223.97,225.51,227.06,228.6,230.14,231.69,233.23,234.77,236.31,237.85,239.4,240.94,242.47,244.02,245.56,247.09,248.63,250.17,251.71,253.24,254.78,256.31,257.84,259.38,260.91,262.44,263.97,265.5,267.03,268.55,270.08,271.6,273.12,274.64,276.16,277.68,279.19,280.71,282.22,283.73,285.24,286.74,288.25,289.75,291.25,292.75,294.25,295.74,297.24,298.73,300.22,301.7,303.18,304.67,306.14,307.62,309.1,310.56,312.04,313.5,314.97,316.43,317.88,319.34,320.79,322.24,323.69,325.13,326.57,328.01,329.45,330.88,332.3,333.73,335.15,336.57,337.98,339.4,340.8,342.21,343.61,345.01,346.4,347.79,349.18,350.57,351.94,353.32,354.69,356.06,357.42,358.79,360.14,361.5,362.84,364.19,365.53,366.86,368.2,369.52,370.85,372.17,373.48,374.79,376.1,377.4,378.7,379.99,381.28,382.56,383.84,385.12,386.39,387.65,388.91,390.17,391.42,392.66,393.9,395.14,396.37,397.6,398.82,400.04,401.25,402.46,403.66,404.85,406.05,407.23,408.41,409.59,410.76,411.92,413.08,414.24,415.38,416.53,417.66,418.8,419.92,421.05,422.16,423.27,424.37,425.47,426.57,427.65,428.74,429.81,430.88,431.95,433.01,434.06,435.1,436.14,437.18,438.21,439.23,440.25,441.26,442.26,443.26,444.25,445.24,446.22,447.19,448.16,449.12,450.08,451.02,451.97,452.9,453.83,454.76,455.67,456.58,457.49,458.38,459.28,460.16,461.04,461.91,462.78,463.63,464.48,465.33,466.17,467,467.82,468.64,469.45,470.26,471.06,471.85,472.63,473.4,474.18,474.94,475.7,476.45,477.19,477.92,478.65,479.38,480.09,480.8,481.5,482.2,482.88,483.56,484.23,484.9,485.55,486.21,486.85,487.49,488.12,488.74,489.36,489.96,490.56,491.16,491.74,492.32,492.89,493.46,494.02,494.57,495.11,495.64,496.17,496.69,497.2,497.71,498.2,498.7,499.18,499.66,500.12,500.58,501.04,501.48,501.92,502.35,502.77,503.19,503.6,504,504.39,504.77,505.15,505.52,505.88,506.24,506.58,506.92,507.25,507.58,507.89,508.21,508.51,508.8,509.09,509.36,509.63,509.89,510.15,510.4,510.63,510.87,511.09,511.31,511.52,511.72,511.91,512.1,512.27,512.45,512.6,512.76,512.9,513.04,513.17,513.3,513.41,513.52,513.62,513.71,513.8,513.87,513.94,514,514.06,514.1,514.13,514.17,514.19,514.2,514.2,514.2,514.19,514.18,514.15,514.12,514.08,514.03,513.97,513.91,513.83,513.75,513.66,513.57,513.47,513.36,513.24,513.11,512.97,512.84,512.68,512.52,512.36,512.19,512.01,511.82,511.62,511.42,511.2,510.98,510.76,510.52,510.28,510.02,509.76,509.5,509.22,508.94,508.65,508.35,508.05,507.74,507.42,507.09,506.75,506.41,506.06,505.7,505.33,504.96,504.58,504.19,503.8,503.39,502.98,502.56,502.13,501.7,501.26,500.81,500.35,499.88,499.41,498.93,498.45,497.95,497.45,496.94,496.43,495.9,495.37,494.83,494.29,493.73,493.17,492.6,492.03,491.44,490.86,490.25,489.65,489.04,488.42,487.79,487.16,486.52,485.87,485.22,484.55,483.89,483.2,482.52,481.83,481.13,480.43,479.72,479,478.27,477.54,476.8,476.05,475.3,474.54,473.77,472.99,472.22,471.42,470.63,469.83,469.02,468.2,467.38,466.55,465.72,464.87,464.03,463.17,462.31,461.44,460.56,459.68,458.8,457.9,456.99,456.09,455.17,454.25,453.32,452.39,451.45,450.51,449.55,448.59,447.63,446.65,445.67,444.69,443.7,442.71,441.7,440.69,439.68,438.66,437.63,436.6,435.56,434.51,433.46,432.41,431.34,430.27,429.2,428.12,427.03,425.94,424.84,423.74,422.63,421.52,420.4,419.27,418.14,417,415.86,414.71,413.56,412.4,411.24,410.07,408.89,407.71,406.53,405.34,404.14,402.94,401.73,400.52,399.31,398.09,396.86,395.63,394.39,393.15,391.9,390.65,389.39,388.14,386.87,385.6,384.33,383.05,381.76,380.47,379.18,377.88,376.58,375.28,373.96,372.65,371.33,370,368.68,367.34,366,364.66,363.32,361.97,360.61,359.26,357.89,356.53,355.16,353.79,352.41,351.03,349.65,348.26,346.86,345.47,344.07,342.67,341.26,339.85,338.44,337.02,335.6,334.18,332.75,331.32,329.88,328.45,327.01,325.56,324.12,322.67,321.22,319.77,318.3,316.85,315.38,313.92,312.45,310.98,309.5,308.02,306.55,305.06,303.58,302.1,300.6,299.11,297.62,296.12,294.62,293.12,291.62,290.11,288.61,287.1,285.59,284.08,282.56,281.05,279.53,278.01,276.49,274.97,273.44,271.91,270.39,268.86,267.33,265.8,264.26,262.73,261.2,259.66,258.12,256.59,255.05,253.5,251.96,250.42,248.88,247.34,245.79,244.25,242.7,241.15,239.61,238.06,236.51,234.97,233.42,231.87,230.32,228.78,227.22,225.68,224.13,222.58,221.03,219.48,217.94,216.39,214.84,213.3,211.75,210.2,208.66,207.11,205.57,204.03,202.48,200.95,199.4,197.86,196.33,194.79,193.25,191.72,190.18,188.65,187.12,185.59,184.06,182.53,181.01,179.48,177.96,176.44,174.92,173.41,171.89,170.38,168.87,167.36,165.86,164.35,162.85,161.35,159.85,158.36,156.87,155.38,153.89,152.41,150.92,149.45,147.97,146.5,145.03,143.56,142.1,140.64,139.18,137.73,136.28,134.84,133.39,131.95,130.52,129.08,127.65,126.23,124.81,123.39,121.98,120.57,119.16,117.77,116.37,114.98,113.59,112.21,110.83,109.46,108.09,106.72,105.37,104.01,102.66,101.32,99.982,98.646,97.316,95.996,94.676,93.361,92.057,90.753,89.459,88.165,86.882,85.605,84.332,83.065,81.803,80.552,79.3,78.06,76.824,75.594,74.369,73.154,71.945,70.741,69.548,68.355,67.172,66,64.828,63.666,62.515,61.364,60.229,59.094,57.969,56.855,55.741,54.643,53.544,52.46,51.382,50.311,49.249,48.194,47.148,46.11,45.081,44.059,43.047,42.043,41.047,40.06,39.083,38.113,37.153,36.202,35.26,34.326,33.403,32.488,31.583,30.687,29.8,28.924,28.056,27.199,26.351,25.513,24.685,23.867,23.058,22.26,21.472,20.694,19.926,19.169,18.421,17.684,16.958,16.241,15.535,14.84,14.155,13.48,12.815,12.161,11.517,10.882,10.258,9.6434,9.0388,8.4427,7.8556,7.2764,6.7051,6.1401,5.5799,5.0231,4.4668,3.9069,3.3367,2.7447,2.1068,1.359]

Epprat=[0.00504,0.01008,0.01512,0.02016,0.0252,0.03024,0.03528,0.04032,0.04537,0.05041,0.05545,0.06049,0.06553,0.07057,0.07561,0.08065,0.08569,0.09073,0.09577,0.10081,0.10585,0.11089,0.11593,0.12097,0.12601,0.13106,0.1361,0.14114,0.14618,0.15122,0.15626,0.1613,0.16634,0.17138,0.17642,0.18146,0.1865,0.19154,0.19658,0.20162,0.20666,0.21171,0.21675,0.22179,0.22683,0.23187,0.23691,0.24195,0.24699,0.25203,0.25707,0.26211,0.26715,0.27219,0.27723,0.28227,0.28731,0.29235,0.2974,0.30244,0.30748,0.31252,0.31756,0.3226,0.32764,0.33268,0.33772,0.34276,0.3478,0.35284,0.35788,0.36292,0.36796,0.373,0.37804,0.38309,0.38813,0.39317,0.39821,0.40325,0.40829,0.41333,0.41837,0.41838]
fpprat=[2.093e+08,8.2524e+08,1.8359e+09,3.2172e+09,4.9634e+09,7.0504e+09,9.4604e+09,1.2187e+10,1.5207e+10,1.8502e+10,2.2072e+10,2.5887e+10,2.9936e+10,3.4212e+10,3.8685e+10,4.3355e+10,4.8205e+10,5.3216e+10,5.8371e+10,6.3669e+10,6.9087e+10,7.4612e+10,8.0234e+10,8.5933e+10,9.1703e+10,9.7534e+10,1.034e+11,1.093e+11,1.1522e+11,1.2114e+11,1.2706e+11,1.3295e+11,1.3882e+11,1.4464e+11,1.504e+11,1.5611e+11,1.6172e+11,1.6725e+11,1.7268e+11,1.78e+11,1.8319e+11,1.8824e+11,1.9315e+11,1.979e+11,2.0248e+11,2.0687e+11,2.1108e+11,2.1508e+11,2.1886e+11,2.2242e+11,2.2574e+11,2.2881e+11,2.3161e+11,2.3414e+11,2.3638e+11,2.3833e+11,2.3996e+11,2.4126e+11,2.4222e+11,2.4282e+11,2.4305e+11,2.4289e+11,2.4232e+11,2.4133e+11,2.3988e+11,2.3797e+11,2.3556e+11,2.3262e+11,2.2913e+11,2.2504e+11,2.2032e+11,2.149e+11,2.0874e+11,2.0177e+11,1.9388e+11,1.8497e+11,1.7489e+11,1.6343e+11,1.5031e+11,1.3508e+11,1.1701e+11,9.4675e+10,6.4482e+10,0]

Epep=[1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44,1.44]
fpep=[0,3.3389e+06,6.6778e+06,1.0017e+07,1.3356e+07,1.6695e+07,2.0033e+07,2.3372e+07,2.6711e+07,3.005e+07,3.3389e+07,3.6728e+07,4.0067e+07,4.3406e+07,4.6745e+07,5.0084e+07,5.3423e+07,5.6762e+07,6.01e+07,6.3439e+07,6.6778e+07,7.0117e+07,7.3456e+07,7.6795e+07,8.0134e+07,8.3473e+07,8.6812e+07,9.0151e+07,9.349e+07,9.6828e+07,1.0017e+08,1.0351e+08,1.0685e+08,1.1018e+08,1.1352e+08,1.1686e+08,1.202e+08,1.2354e+08,1.2688e+08,1.3022e+08,1.3356e+08,1.369e+08,1.4023e+08,1.4357e+08,1.4691e+08,1.5025e+08,1.5359e+08,1.5693e+08,1.6027e+08,1.6361e+08,1.6695e+08,1.7028e+08,1.7362e+08,1.7696e+08,1.803e+08,1.8364e+08,1.8698e+08,1.9032e+08,1.9366e+08,1.97e+08,2.0033e+08,2.0367e+08,2.0701e+08,2.1035e+08,2.1369e+08,2.1703e+08,2.2037e+08,2.2371e+08,2.2705e+08,2.3038e+08,2.3372e+08,2.3706e+08,2.404e+08,2.4374e+08,2.4708e+08,2.5042e+08,2.5376e+08,2.571e+08,2.6044e+08,2.6377e+08,2.6711e+08,2.7045e+08,2.7379e+08,2.7713e+08,2.8047e+08,2.8381e+08,2.8715e+08,2.9049e+08,2.9382e+08,2.9716e+08,3.005e+08,3.0384e+08,3.0718e+08,3.1052e+08,3.1386e+08,3.172e+08,3.2054e+08,3.2387e+08,3.2721e+08,3.3055e+08,3.3389e+08,3.3723e+08,3.4057e+08,3.4391e+08,3.4725e+08,3.5059e+08,3.5392e+08,3.5726e+08,3.606e+08,3.6394e+08,3.6728e+08,3.7062e+08,3.7396e+08,3.773e+08,3.8064e+08,3.8397e+08,3.8731e+08,3.9065e+08,3.9399e+08,3.9733e+08,4.0067e+08,4.0401e+08,4.0735e+08,4.1069e+08,4.1403e+08,4.1736e+08,4.207e+08,4.2404e+08,4.2738e+08,4.3072e+08,4.3406e+08,4.374e+08,4.4074e+08,4.4408e+08,4.4741e+08,4.5075e+08,4.5409e+08,4.5743e+08,4.6077e+08,4.6411e+08,4.6745e+08,4.7079e+08,4.7413e+08,4.7746e+08,4.808e+08,4.8414e+08,4.8748e+08,4.9082e+08,4.9416e+08,4.975e+08,5.0084e+08,5.0418e+08,5.0751e+08,5.1085e+08,5.1419e+08,5.1753e+08,5.2087e+08,5.2421e+08,5.2755e+08,5.3089e+08,5.3423e+08,5.3756e+08,5.409e+08,5.4424e+08,5.4758e+08,5.5092e+08,5.5426e+08,5.576e+08,5.6094e+08,5.6428e+08,5.6762e+08,5.7095e+08,5.7429e+08,5.7763e+08,5.8097e+08,5.8431e+08,5.8765e+08,5.9099e+08,5.9433e+08,5.9767e+08,6.01e+08,6.0434e+08,6.0768e+08,6.1102e+08,6.1436e+08,6.177e+08,6.2104e+08,6.2438e+08,6.2772e+08,6.3105e+08,6.3439e+08,6.3773e+08,6.4107e+08,6.4441e+08,6.4775e+08,6.5109e+08,6.5443e+08,6.5777e+08,6.611e+08,6.6444e+08,6.6778e+08,6.7112e+08,6.7446e+08,6.778e+08,6.8114e+08,6.8448e+08,6.8782e+08,6.9115e+08,6.9449e+08,6.9783e+08,7.0117e+08,7.0451e+08,7.0785e+08,7.1119e+08,7.1453e+08,7.1787e+08,7.2121e+08,7.2454e+08,7.2788e+08,7.3122e+08,7.3456e+08,7.379e+08,7.4124e+08,7.4458e+08,7.4792e+08,7.5126e+08,7.5459e+08,7.5793e+08,7.6127e+08,7.6461e+08,7.6795e+08,7.7129e+08,7.7463e+08,7.7797e+08,7.8131e+08,7.8464e+08,7.8798e+08,7.9132e+08,7.9466e+08]

fig,ax = plt.subplots()
ax.set_xscale('log')
ax.set_yscale('log')
ax.set_xlim(0.1, 21)
ax.set_ylim(10, 10e12)
ax.plot(ECNOrat,fCNOrat,label='CNO')
ax.plot(Epprat,fpprat,label='pp')
ax.plot(Eheprat,fheprat,label='hep')
ax.plot(Ebrat,fbrat,label='$^{8}$B')
ax.plot(Ebe1rat,fbe1rat,label='$^{7}$Be')
ax.plot(Ebe2rat,fbe2rat,label='$^{7}$Be')
ax.plot(Epep,fpep,label='pep')

plt.title('Solar Neutrino Spectrum in RAT-PAC Format')
ax.set_xlabel("Energy [MeV]")
ax.set_ylabel("Flux [cm$^{-2}$ s$^{-1}$ MeV$^{-1}$]")
ax.legend()
ax.plot()
plt.savefig(dirname + "/../plots/comparesolarspectraRATDB.pdf")
plt.show()

#Data from .dat files used to generate .ratdb files

#integrated fluxes from N Vingoles
fi_pp = 5.98e10
fi_be1 = 5e8 # ~~~~~placeholder value~~~~~
fi_be2 = 1.44e9
fi_pep = 7.98e8
fi_n = 4.93e8
fi_o = 5.46e8
fi_b = 2.78e6
fi_f = 2.05e6
fi_hep = 5.28e3

# read data for the neutrinos. Flux in cm^-2 s^-1 at Earth's surface, E in MeV
n13 = np.genfromtxt(dirname + "/../data/n13.dat", delimiter="  ") # sns.ias.edu
o15 = np.genfromtxt(dirname + "/../data/o15.dat", delimiter="  ") # ''
f17 = np.genfromtxt(dirname + "/../data/f17.dat", delimiter="  ") # ''
hep = np.genfromtxt(dirname + "/../data/hep.dat", delimiter="  ") # ''
b8 = np.genfromtxt(dirname + "/../data/b8.dat", usecols=[0, 1]) # ''
pp_raw = np.genfromtxt(dirname + "/../data/pp.dat") # ''
be7_raw = np.genfromtxt(dirname + "/../data/be7.dat") # ''
En = n13[:, 0]
fn = n13[:, 1]*fi_n
Eo = o15[:, 0]
fo = o15[:, 1]*fi_o
Ef = f17[:, 0]
ff = f17[:, 1]*fi_f
Ehep = hep[:, 0]
fhep = hep[:, 1]
Eb = b8[:, 0]
fb = b8[:, 1]
Ebe2 = (be7_raw[:92, 0] / 1000) + .8613 # converting from keV to MeV then adding 861.3 keV to return to energy
fbe2 = be7_raw[:92, 1]*fi_be2
Ebe1 = (be7_raw[92:, 0] / 1000) + .3843
fbe1 = be7_raw[92:, 1]*fi_be1

Epep = 1.44 # Solar Neutrinos Spectroscopy 1704.06331

col1 = np.array(np.concatenate((pp_raw[:, 0], pp_raw[:, 2], pp_raw[:, 4], pp_raw[:, 6])))
col2 = np.array(np.concatenate((pp_raw[:, 1], pp_raw[:, 3], pp_raw[:, 5], pp_raw[:, 7])))
ppn = np.column_stack((col1, col2))

Epp = ppn[:, 0]
fpp = ppn[:, 1]

En = np.concatenate((En, Eo[200:]))
fn = np.concatenate((fn, np.linspace(0, 0, 300)))

fig,ax = plt.subplots()
ax.set_xscale('log')
ax.set_yscale('log')
ax.set_xlim(0.1, 21)
ax.set_ylim(10, 10e12)

ax.plot(Eo, fo, label='O', linestyle='--')
ax.plot(En, fn, label='N')
ax.plot(Ef, ff, label='F', linestyle=':')
ax.plot(Ehep, fhep*fi_hep, label='hep')
ax.plot(Eb, fb*fi_b, label='$^8$B')
ax.plot(Epp, fpp*fi_pp, label='pp')
ax.plot(Ebe1, fbe1, label = '$^7$Be')
ax.plot(Ebe2, fbe2, label = '$^7$Be')
ax.plot([Epep,Epep], [0, fi_pep*0.5], label = 'pep')
plt.title('Solar Neutrino Spectrum from Data Files')
ax.set_xlabel("Energy [MeV]")
ax.set_ylabel("Flux [cm$^{-2}$ s$^{-1}$ MeV$^{-1}$]")
ax.legend()
ax.plot()
plt.savefig(dirname + "/../plots/solarspectra.pdf")
plt.show()

